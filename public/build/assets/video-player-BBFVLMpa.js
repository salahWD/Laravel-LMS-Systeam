playerNeeded&&(window.addEventListener("keydown",function(e){e.keyCode==32&&e.target==document.body&&e.preventDefault()}),window.onload=function(){let e=document.getElementById("video"),o=document.getElementById("video-holder"),r=document.getElementById("start-stop"),n=document.getElementById("volume"),h=document.getElementById("mute-control"),a=document.getElementById("volume-level"),k=document.getElementById("input-area"),w=document.getElementById("input-thumb"),i=document.getElementById("line"),f=document.getElementById("hovered-line"),E=document.getElementById("loaded-line");document.getElementById("watched-line"),document.getElementById("watched-thumb");let p=document.getElementById("screen-btn"),I=document.getElementById("time-stamp"),v=document.getElementById("current-time"),l=!1;e.focus(),I.innerHTML=Math.round(e.duration),s(0),d(60);function u(){r.classList.toggle("active"),r.classList.contains("active")?(e.play(),o.classList.remove("stop"),document.querySelector(".video .card.stop").classList.add("active"),setTimeout(()=>{document.querySelector(".video .card.stop").classList.remove("active")},500)):(e.pause(),o.classList.add("stop"),document.querySelector(".video .card.start").classList.add("active"),setTimeout(()=>{document.querySelector(".video .card.start").classList.remove("active")},500))}function d(t=50){e.volume=t/100,k.style.width=`${Math.ceil(t/100*a.clientWidth)}px`,w.style.left=`${Math.ceil(t/100*(a.clientWidth-8))}px`,t>=50?(n.classList.add("high"),n.classList.remove("low"),n.classList.remove("mute")):t<50&&t>0?(n.classList.remove("high"),n.classList.add("low"),n.classList.remove("mute")):(t==0,n.classList.remove("high"),n.classList.remove("low"),n.classList.add("mute"))}function B(){n.classList.contains("mute")?(n.classList.remove("mute"),e.muted=!1):(n.classList.add("mute"),e.muted=!0)}function y(){l?e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullscreen?e.mozCancelFullscreen():e.exitFullscreen&&e.exitFullscreen():e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function T(t){const c=t/e.duration;E.style.width=`${c*i.clientWidth}px`,console.log(`percentage is ${c*100}%`)}function L(){const t=e.duration;t>0&&i.style.setProperty("--watched-width",`${e.currentTime/t*i.clientWidth}px`)}function s(t){v.innerHTML=Math.round(t*e.duration),e.currentTime=t*e.duration,L()}e.addEventListener("contextmenu",t=>t.preventDefault()),e.addEventListener("click",function(t){u()}),r.addEventListener("click",function(t){u()}),a.addEventListener("input",function(t){d(this.value)}),h.addEventListener("click",function(){B()}),i.addEventListener("mousemove",function(t){let{x:c}=i.getBoundingClientRect();if(f.style.width=`${t.clientX-c}px`,t.buttons==1&&t.button==0){let m=(t.clientX-c)/i.clientWidth;s(m)}}),i.addEventListener("mouseleave",()=>f.style.width="0"),i.addEventListener("click",function(t){let{x:c}=i.getBoundingClientRect(),m=(t.clientX-c)/i.clientWidth;s(m)}),p.addEventListener("click",y),e.addEventListener("fullscreenchange",function(t){l=!l}),e.addEventListener("webkitfullscreenchange",function(t){l=!l}),e.addEventListener("mozfullscreenchange",function(t){l=!l}),window.addEventListener("keydown",function(t){t.key==" "||t.key=="k"||t.key=="K"||t.key=="ن"?u():t.key=="f"||t.key=="F"||t.key=="ب"?y():t.key=="ArrowUp"?(vol=Math.round(+e.volume*100),vol<100&&d(vol+5)):t.key=="ArrowDown"?(vol=Math.round(+e.volume*100),vol>5?d(vol-5):d(0)):t.key=="ArrowRight"?(s((+e.currentTime+5)/e.duration),document.querySelector(".video .card.forward").classList.add("active"),setTimeout(()=>{document.querySelector(".video .card.forward").classList.remove("active")},500)):t.key=="ArrowLeft"?(s((+e.currentTime-5)/e.duration),document.querySelector(".video .card.backward").classList.add("active"),setTimeout(()=>{document.querySelector(".video .card.backward").classList.remove("active")},500)):t.key=="l"||t.key=="L"||t.key=="م"?(s((+e.currentTime+10)/e.duration),document.querySelector(".video .card.forward").classList.add("active"),setTimeout(()=>{document.querySelector(".video .card.forward").classList.remove("active")},500)):t.key=="j"||t.key=="J"||t.key=="ت"?(s((+e.currentTime-10)/e.duration),document.querySelector(".video .card.backward").classList.add("active"),setTimeout(()=>{document.querySelector(".video .card.backward").classList.remove("active")},500)):parseInt(t.key)>=0&&parseInt(t.key)<=9&&(s(parseInt(t.key)/10),console.log(e.duration),console.log(parseInt(t.key)/10))}),e.addEventListener("progress",()=>{if(e.duration>0){for(let t=0;t<e.buffered.length;t++)if(e.buffered.start(e.buffered.length-1-t)<e.currentTime){T(e.buffered.end(e.buffered.length-1-t));break}}});let g=!0;e.addEventListener("timeupdate",()=>{e.currentTime/e.duration*100>90&&g&&(g=!1,markLectureAsDone()),v.innerHTML=Math.round(e.currentTime),L()})});window.markLectureAsDone=function(){$.ajax(doneUrl,{method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){if(e.result){const o=document.getElementById("next-lecture");o.style="display: block",setTimeout(function(){document.getElementById("next-lecture").classList.add("animateIn")},100)}}})};
